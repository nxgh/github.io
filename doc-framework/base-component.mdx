---
title: 组件基础:组件结构
index: 1
date: 2023/01/05
---

# 组件基础

- 前端开发普遍采用「组件」作为「状态与 UI 的松散耦合单元」，
- Angular 使用 NgModule 来组织组件, Angular 14 提供了 standalone 来简化这一过程


## 组件结构

### Angular

运行 `ng generate component <component-name>` 会生成如下文件

```bash
<component-name>/
  - <component-name>.component.ts
  - <component-name>.component.css
  - <component-name>.component.html
  - <component-name>.component.spec.ts
```

一个最小化的 Angular 组件结构如下：

- 一个 HTML 模板，用于声明页面要渲染的内容
- 一个用于定义行为的 TypeScript 类
- 一个 CSS 选择器，用于定义组件在模板中的使用方式
- 要应用在模板上的 CSS 样式(可选)

<CH.Code>

```ts
import { Component } from '@angular/core'

@Component({
  selector: 'hello-world',
  template: `
    <h2>Hello World</h2>
    <p>This is my first component!</p>
  `,
  styles: ['h2 { color: red; }'],
})
export class HelloWorldComponent {
  // The code in this class drives the component's behavior.
}
```

</CH.Code>

对于 angular ，你可以选择内联 template/css ，也可以选择外部 template/css

<CH.Code>

```ts app.component.ts
import { Component } from '@angular/core'

@Component({
  selector: 'hello-world',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css'],
})
export class HelloWorldComponent {
  // The code in this class drives the component's behavior.
}
```

```html app.component.html
<h2>Hello World</h2>
<p>This is my first component!</p>
```

```css app.component.css
h2 {
  color: red;
}
```

</CH.Code>

### Vue

vue 使用 SFC 作为组件结构，SFC (Single-File Component,单文件组件)，包含了 template、script、style 三个部分

```vue
<script setup>
const attributeName = 'href'
const url = 'https://'
</script>

<template>
  <h2>Hello World</h2>
  <p>This is my first component!</p>
</template>

<style>
h2 {
  color: red;
}
</style>
```

如果你更喜欢将 \*.vue 组件分散到多个文件中，可以为一个语块使用 src 这个 attribute 来导入一个外部文件

<CH.Code>

```vue app.vue
<template src="./template.html"></template>
<style src="./style.css"></style>
<script src="./script.js"></script>
```

</CH.Code>

### React

react 使用 jsx 作为组件结构，jsx 是一种语法糖，可以让我们在 js 中书写 html

<CH.Code>

```jsx
import './style.css'

function App() {
  return (
    <>
      <h2>Hello World</h2>
      <p>This is my first component!</p>
    </>
  )
}
```

```css style.css
h2 {
  color: red;
}
```

</CH.Code>

## 组件的注册及使用

### Vue

一个 Vue 组件在使用前需要先被“注册”，这样 Vue 才能在渲染模板时找到其对应的实现。组件注册有两种方式：全局注册和局部注册

- 全局注册

<CH.Code>

```js main.js
import { createApp } from 'vue'
import MyComponent from './App.vue'

const app = createApp({})

app.component(MyComponent)
```

</CH.Code>

- 局部注册

<CH.Code>

```vue App.vue
<script setup>
import ComponentA from './ComponentA.vue'
</script>

<template>
  <ComponentA />
</template>
```

```vue AppWithoutSetup.vue
<script>
import ComponentA from './ComponentA.vue'

export default {
  components: {
    ComponentA,
  },
  setup() {
    // ...
  },
}
</script>
```

</CH.Code>

### React

<CH.Code>

```js
import ComponentA from './ComponentA.js'

function App() {
  return <ComponentA />
}
```

</CH.Code>

### Angular

#### NgModule

Angular v14 之前，组件的 “注册” 需要使用 Angular 的模块系统
[`NgModule`](https://v2.angular.cn/docs/ts/latest/guide/ngmodule.html)

- `NgModule` 是 Angular 用来组织内部模块的一种方式
- 每个 Angular 应用都至少有一个 `NgModule`，通常被称为 `AppModule`
- 一个 `NgModule` 包含了一组组件、指令、管道、服务等，它们可以被其他模块引用，也可以被其他模块引用
- 根模块在一些小型应用中可能是唯一的模块，大多数应用会有很多特性模块，每个模块都是一个内聚的代码块专注于某个应用领域、工
  作流或紧密相关的功能。
- Angular 模块都是一个带有 `@NgModule` 装饰器的类

[NgModule Api](https://angular.cn/api/core/NgModule)

<CH.Code>

```ts app/app.module.ts
import { NgModule } from '@angular/core'
import { BrowserModule } from '@angular/platform-browser'

import { AppRoutingModule } from './app-routing.module'
import { AppComponent } from './app.component'

@NgModule({
  declarations: [AppComponent],
  imports: [BrowserModule, AppRoutingModule],
  providers: [],
  bootstrap: [AppComponent],
})
export class AppModule {}
```

```ts main.ts
import { platformBrowserDynamic } from '@angular/platform-browser-dynamic'

import { AppModule } from './app/app.module'

platformBrowserDynamic()
  .bootstrapModule(AppModule)
  .catch((err) => console.error(err))
```

</CH.Code>

举个 🌰

我们有一个 hello 组件

```ts src/app/hello/hello.component.ts
import { Component } from '@angular/core'

@Component({
  selector: 'app-hello',
  template: `<h2>Hello World</h2>`,
})
export class HelloComponent {}
```

在使用的 Module 中导入这个组件

```ts app/app.module.ts
// ...
import { HelloComponent } from './hello/hello.component'

@NgModule({
  declarations: [AppComponent, HelloComponent],
  imports: [BrowserModule, AppRoutingModule],
  providers: [],
  bootstrap: [AppComponent],
})
export class AppModule {}
```

在使用 `ng generate component` 命令创建组件时，Angular 会自动将组件注册到 `app.module.ts` 中

NgModule 的参数:

- `declarations`：用于声明本模块中拥有的视图类，Angular 有三种视图类：组件、指令和管道。

#### standalone

在 v14 及更高版本中，[独立组件](https://angular.cn/guide/standalone-components)提供了一种简化的方式来构建 Angular 应用程
序。

通过这种方式，可以编写独立组件，而无需创建 NgModule 来管理模板依赖项。

<CH.Code>

```ts app.component.ts
import { HelloComponent } from './hello/hello.component'

@Component({
  standalone: true,
  selector: 'app-root',
  template: `<hello></hello>`,
  // HelloComponent 也必须是 standalone 组件
  imports: [HelloComponent],
})
export class AppComponent {}
```

```ts hello.component.ts
import { Component } from '@angular/core'

@Component({
  standalone: true,
  selector: 'app-hello',
  template: `<h2>Hello World</h2>`,
})
export class HelloComponent {}
```

</CH.Code>

## 其他

- 动态组件
- 懒加载
