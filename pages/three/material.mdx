# 材质

| 材质                 | 描述                                                                             |
| :------------------- | :------------------------------------------------------------------------------- |
| LineBasicMaterial    | 一种用于绘制线框样式几何体的材质                                                 |
| LineDashedMaterial   | 一种用于绘制虚线样式几何体的材质。                                               |
| MeshBasicMaterial    | 一个以简单着色（平面或线框）方式来绘制几何体的材质。                             |
| MeshDepthMaterial    | 一种按深度绘制几何体的材质。深度基于相机远近平面。白色最近，黑色最远。           |
| MeshLambertMaterial  | 一种非光泽表面的材质，没有镜面高光。用于创建暗淡的、不光亮的物体                 |
| MeshNormalMaterial   | 一种把法向量映射到 RGB 颜色的材质。                                              |
| MeshPhongMaterial    | 一种用于具有镜面高光的光泽表面的材质。                                           |
| MeshPhysicalMaterial | MeshStandardMaterial 的扩展，提供了更高级的基于物理的渲染属性：                  |
| MeshStandardMaterial | 一种基于物理的标准材质                                                           |
| MeshToonMaterial     | MeshPhongMaterial 的扩展材质，使得物体渲染更加卡通化                             |
| ShaderMaterial       | 着色器材质，允许使用自定义的着色器程序，直接控制顶点的放置方式以及像素的着色方式 |
| ShadowMaterial       | 此材质可以接收阴影，但在其他方面完全透明。                                       |

## 材质的属性

- 基础属性: 这些属性是最常用的。通过这些属性,可以控制物体的不透明度、是否可见以及如何被引用。
- 融合属性: 每个物体都有一系列的融合属性。这些属性决定了物体如何与背景融合
- 高级属性: 有一些高级属性可以控制底层 WebGL 上下文对象渲染物体的方式。大多数情况下是不需要使用这些
  属性的

| 属性                                   | 描述                                                                                                                                                                                                                                                                                                                        |
| :------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| id(标识符)                             | 用来识别材质,并在材质创建时赋值。第一个材质的值从 0 开始,每新加一个材质,这个值增加 1                                                                                                                                                                                                                                        |
| uuid(通用唯一识别码)                   | 这是生成的唯一 ID,在内部使用                                                                                                                                                                                                                                                                                                |
| name (名称)                            | 可以通过这个属性赋予材质名称,用于调试的目的                                                                                                                                                                                                                                                                                 |
| opacity(不透明度)                      | 定义物体的透明度。与 transparent 属性一起使用。该属性的赋值范围从 0 到 1                                                                                                                                                                                                                                                    |
| transparent (是否透明)                 | 如果该值设置为 true,Three.js 会使用指定的不透明度渲染物体。如果设置为 false,这个物体就不透明,只是着色更明亮些。如果使用 alpha(透明度)通道的纹理 该属性应该设置为 true                                                                                                                                                       |
| overdraw(过度描绘)                     | 当你使用 THREE.CanvasRender 时,多边形会被渲染得稍微大一点。当使 用这个渲染器渲染的物体有间隙时,可以将这个属性设置为 true                                                                                                                                                                                                    |
| visible (是否可见)                     | 定义该材质是否可见。如果设置为 false,那么在场景中就看不到该物体                                                                                                                                                                                                                                                             |
| side (侧面)                            | 通过这个属性,可以定义几何体的哪一面应用材质。默认值为 THREE.FrontSide(前面)。也可以将它设置为 THREE.BackSide (后面) 或 THREE.DoubleSide (双侧)                                                                                                                                                                              |
| needsUpdate (是否更新)                 | 对于材质的某些修改,你需要告诉 Three.js 材质已经改变了。如果该属性 设置为 true, Three.js 会使用新的材质属性更新它的缓存                                                                                                                                                                                                      |
| colorWrite (是否输出颜色)              | 如果该属性值为 false,则具有该材质的物体不会被真正绘制到场景中。实际效果是该物体本身是不可见的,但其他物体被它挡住的部分也不可见                                                                                                                                                                                              |
| flatShading(平面着色)                  | 该属性控制物体表面法线的生成方式,从而影响光照效果。属性值为 true 时,在两个相邻但不共面的三角形之间,光照会因为生硬过渡而产生棱角; 为 false 时则会产生非常平滑的过渡效果                                                                                                                                                      |
| lights(光照)                           | 该属性值为布尔值,控制物体表面是否接受光照。默认值为 true                                                                                                                                                                                                                                                                    |
| premultipliedAlpha (预计算 Alpha 混合) | 该属性控制半透明表面的颜色混合方式。默认值为 false                                                                                                                                                                                                                                                                          |
| dithering (抖动)                       | 该属性控制是否启用颜色抖动模式。该模式可以在一定程度上减轻颜色不均匀的问题。默认值为 false                                                                                                                                                                                                                                  |
| shadowSide (投影面)                    | 这个属性与上面的 side 属性有些类似,但它控制的是物体的哪个面会投射阴影。默认值为 null。当该属性值为 null 时,投射阴影的面按照如下原则推定: 当 side 为 THREE.FrontSide 时 shadowSide 为后面; 当 side 为 THREE.BackSide 时, shadowSide 为前面; 当 side 为 THREE.DoubleSide 时,shadowSide 也为前面双侧",                         |
| vertexColors (顶点颜色)                | 你可以为物体的每一个顶点指定特有的颜色。该属性的默认值为 THREE.NoColors。如果设定属性值为 THREE.VertexColors,则渲染时将使用 HEEEBace3 vertexColors 数组指定的颜色,为每一个顶点设定颜色。如果该属性值为 THREE.FaceColors,则会使用每一个面自己的颜色属性来设定面的颜色。CanvasRenderer 不支持该属性,但 WebGLRenderer 能够支持 |
| fog(雾)                                | 该属性控制材质是否受到雾的影响。如果这个属性设置为 false, 场景中的物体将不会有雾化效果                                                                                                                                                                                                                                      |

融合属性

| 属性                           | 描述                                                                                                                                                                                                                 |
| :----------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| blending (融合)                | 该属性决定物体上的材质如何与背景融合。一般的融合模式是 THREE.NormalBlending,在这种模式下只显示材质的上层                                                                                                             |
| blendSrc(融合源)               | 除了使用标准融合模式之外,还可以通过设置 blendSrc、blendDst 和 blendEquation 来创建自定义的融合模式。这个属性定义了该物体(源)如何 与背景(目标)相融合。默认值为 THREE.SrcAlphaFactor, 即使用 alpha(透明度)通道进行融合 |
| blendSrcAlpha(融合源透明度)    | 该属性为 blendSrc 指定透明度。默认值为 null                                                                                                                                                                          |
| blendDst (融合目标)            | 这个属性定义了融合时如何使用背景(目标),默认值为 THREE.One MinusSrcAlphaFactor,其含义是目标也使用源的 alpha 通道进行融合,只是 使用的值是 1(源的 alpha 通道值)                                                         |
| blendDstAlpha (融合目标透明度) | 该属性为 blendDst 指定透明度。默认值为 null                                                                                                                                                                          |
| blendEquation (融合公式)       | 定义了如何使用 blendSrc 和 blendDst 的值。默认值为使它们相加 (AddEquation)。通过使用这三个属性,可以创建自定义的融合模式                                                                                              |

<CH.Scrollycoding preset="https://codesandbox.io/s/7wt1zq">

Three.js 提供了多种类型的材质（material）。它们定义了对象在场景中的外型。你使用哪种材质取决于你想达
到的目的。

有 2 种方法可以设置大部分的材质属性。一种是在实例化时设置，也就是我们之前看到的。

<CH.Section>
```js
const material = new THREE.MeshPhongMaterial({
  color: 0xff0000, // 红色 (也可以使用CSS的颜色字符串)
  flatShading: true,
})
```

</CH.Section>

<CH.Section>
另一种是在实例化之后再设置

```js
const material = new THREE.MeshPhongMaterial()
material.color.setHSL(0, 1, 0.5) // 红色
material.flatShading = true
```

属性 `flatShading: Boolean`: 定义材质是否使用平面着色进行渲染。默认值为 false

</CH.Section>

```js src/index.js
// from ../../data/three/material/s1.js
```

---

<CH.Section>

THREE.Color 类型的属性有多种设置方式

CSS 的 #RRGGBB 风格

```js
material.color.set(0x00ffff)
new THREE.MeshBasicMaterial({ color: 0xff0000 })
```

</CH.Section>

<CH.Section>
任何 CSS 颜色字符串, 比如 `'purple'`, ` '#F32'`,  `'rgb(255, 127, 64)'`, `'hsl(180, 50%, 25%)'`

```js
material.color.set('rgb(255,0,0)')
new THREE.MeshBasicMaterial({ color: 'rgb(255,0,0)' })
```

</CH.Section>
<CH.Section>

其他的方式

```js
material.color.set(someColor) // 其他一些 THREE.Color
material.color.setHSL(h, s, l) // 其中 h, s, 和 l 从 0 到 1
material.color.setRGB(r, g, b) // 其中 r, g, 和 b 从 0 到 1
```

</CH.Section>

```js src/index.js
// from ../../data/three/material/s2.js
```

---

那么，我们就来看看 three.js 的几个材质

| 材质                | 描述                             |
| :------------------ | :------------------------------- |
| MeshBasicMaterial   | 不受光照影响                     |
| MeshLambertMaterial | 只在顶点计算光照                 |
| MeshPhongMaterial   | 在每个像素计算光照，支持镜面高光 |

```js src/index.js
// from ../../data/three/material/s3.js
```

---

### shininess

MeshPhongMaterial 的 shininess 设置决定了镜面高光的光泽度。它的默认值是 30

```js src/index.js
// from ../../data/three/material/s4.js
```

---

### emissive

请注意，将 MeshLambertMaterial 或 MeshPhongMaterial 的 emissive 属性设置为颜色，并将颜色设置为黑色
(phong 的 shininess 为 0)，最终看起来就像 MeshBasicMaterial 一样。

既然 MeshBasicMaterial、MeshLambertMaterial 可以做到的，MeshPhongMaterial 也可以做到，那为什么还要有
这 3 种材质呢？原因是更复杂的材质会消耗更多的 GPU 功耗。在一个较慢的 GPU 上，比如说手机，你可能想通
过使用一个不太复杂的材质来减少绘制场景所需的 GPU 功耗。同样，如果你不需要额外的功能，那就使用最简单
的材质。如果你不需要照明和镜面高光，那么就使用 MeshBasicMaterial 。

```js src/index.js
// from ../../data/three/material/s5.js
```

---

## MeshToonMaterial

MeshToonMaterial 与 MeshPhongMaterial 类似，但有一个很大的不同。它不是平滑地着色，而是使用一个渐变图
（一个 X 乘 1 的纹理（X by 1 texture））来决定如何着色。默认使用的渐变图是前 70%的部分使用 70%的亮度
，之后的部分使用 100%的亮度，当然，你可以定义你自己的渐变图。这最终会给人一种 2 色调的感觉，看起来就
像卡通一样。

```js src/index.js
// from ../../data/three/material/s6.js
```

---

接下来是 2 种基于物理渲染（Physically Based Rendering）的材质。Physically Based Rendering 通常简称为
PBR。

| 材质                 | 描述                                                          |
| :------------------- | :------------------------------------------------------------ |
| MeshStandardMaterial | 一种基于物理的标准材质                                        |
| MeshPhysicalMaterial | MeshStandardMaterial 的扩展，提供了更高级的基于物理的渲染属性 |

## MeshStandardMaterial

MeshPhongMaterial 和 MeshStandardMaterial 最大的区别是它们使用的参数不同

- MeshPhongMaterial 有一个参数用来设置 shininess 属性
- MeshStandardMaterial 有 2 个参数用来分别设置 roughness 和 metalness 属性

| 属性      | 描述                                                                                                                                                                                  |
| :-------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| roughness | 材质的粗糙程度，roughness。 0.0 表示平滑的镜面反射，1.0 表示完全漫反射。默认值为 1.0。如果还提供 roughnessMap，则两个值相乘。                                                         |
| metalness | 材质与金属的相似度。非金属材质，如木材或石材，使用 0.0，金属使用 1.0，通常没有中间值。 默认值为 0.0。0.0 到 1.0 之间的值可用于生锈金属的外观。如果还提供了 metalnessMap，则两个值相乘 |

这里是 MeshStandardMaterial 的一个快速示例，从左至右看，粗糙度从 0 到 1，从上至下看，金属度从 0 到
1。(step 为 0.25)

```js src/index.js
// from ../../data/three/material/s7.js
```

---

MeshPhysicalMaterial 与 MeshStandardMaterial 相同，但它增加了

- clearcoat 参数，该参数从 0 到 1,决定了要涂抹的清漆光亮层的程度
- clearCoatRoughness 参数，指定光泽层的粗糙程度。

各种标准材质的构建速度从最快到最慢：MeshBasicMaterial ➡ MeshLambertMaterial ➡ MeshPhongMaterial ➡
MeshStandardMaterial ➡ MeshPhysicalMaterial。构建速度越慢的材质，做出的场景越逼真，但在低功率或移动
设备上，你可能需要思考代码的设计，使用构建速度较快的材质。

```js src/index.js
// from ../../data/three/material/s8.js
```

---

| 材质               | 描述                                                                                           |
| :----------------- | :--------------------------------------------------------------------------------------------- |
| ShadowMaterial     | 用于获取阴影创建的数据                                                                         |
| MeshDepthMaterial  | 渲染每个像素的深度，其中处在摄像机负近端面的像素其深度为 0，处在摄像机负远端面的像素其深度为 1 |
| MeshNormalMaterial | 显示几何体的法线。法线是一个特定的三角形或像素所面对的方向                                     |
| ShaderMaterial     | 通过 three.js 的着色器系统来制作自定义材质                                                     |
| RawShaderMaterial  | 可以用来制作完全自定义的着色器，不需要 three.js 的帮助                                         |

---



</CH.Scrollycoding>
